### Итоговый проект по курсу "PostgreSQL для администраторов баз данных и разработчиков" ###  
## Тема: "Создание БД для проекта "Интернет-магазин книг" и тестирование его работы с использованием pgbench" ##   
### Первая часть проекта заключалась в разработке минимальной БД в PostgreSQL. ###   
Была разработана схема БД по теме "Интернет-магазин книг". Схема содержит 5 базовых таблиц:  
 - Книги  
 - Склады  
 - Покупатели  
 - Номенклатура продаж (отражает наличие книг на складах, в зависимости от склада книга может иметь разную стоимость и срок доставки)   
 - Заказы   
Также в схеме есть две витрины данных, автоматически заполняемых триггерами по данным базовых таблиц:  
 - Наличие книг  
 - Итоги продаж  
![Логическая схема](/Scripts/Schema_log.jpg)
Этапы разработки:   
[1. Физическая схема](https://github.com/mkalinichenko2023/otus_project/tree/main/Scripts/Schema_fiz.jpg)   
[2. Скрипты создания таблиц схемы](https://github.com/mkalinichenko2023/otus_project/tree/main/Scripts/Create%20DB%20script.txt)   
[3. Скрины создания таблиц схемы](https://github.com/mkalinichenko2023/otus_project/tree/main/Screens/Create%20DB%20screens.md)   
[4. Создание триггерных функций для поддержания витрин в актуальном состоянии](https://github.com/mkalinichenko2023/otus_project/tree/main/Scripts/Add%20functions.txt)   
[5. Скрины триггерных функций для поддержания витрин в актуальном состоянии](https://github.com/mkalinichenko2023/otus_project/tree/main/Screens/Create%20DopFunc.md)   
[6. Заполнила основные таблицы схемы данными (сделала обычную вставку, загрузку готовых списков и генерацию случайных данных с учетом назначения таблиц)](https://github.com/mkalinichenko2023/otus_project/tree/main/Scripts/Load%20data.txt)   
[7. Скрины заполнения основные таблицы схемы данными](https://github.com/mkalinichenko2023/otus_project/tree/main/Screens/Create%20LoadData.md)   
***Итог: Выполненная работа позволила закрепить полученную на курсе информацию по созданию различных объектов БД в PostgreSQL, а также подсветила отличия в работе с PostgreSQL и с СУБД Oracle.***
------------------------   
### Вторая часть проекта заключалась в изучении программы pgbench. ###   
По умолчанию программа pgbench может создавать 4 таблицы (pgbench_accounts, pgbench_branches, pgbench_history и pgbench_tellers), заполнять их данными и прогонять скрипт типа TPC-B для оценки производительности системы.   
Но программа pgbench позволяет задавать свои собственные скрипты тестирования. Скрипты можно написать на основе своих таблиц, что позволит более точно оценить производительность конкретной системы с учетом особенностей ее схемы базы данных.   
Для разработанной схемы "Интернет-магазин книг" сделала три тестовых скрипта для тестирования наиболее встречающихся массовых операций:   
1. Создание нового заказа.   
![Скрипт 1](/Screens/test_file_1.jpg)   
Скрипт вызывает функцию создания заказа:   
![Функция 1](/Screens/function_test_1.jpg)   
Вызов скрипта тестирования:   
![Тест 1](/Screens/test1.jpg)   
1. Инвентаризация наличия книг на складе.   
![Скрипт 2](/Screens/test_file_2.jpg)   
Скрипт вызывает функцию изменения таблицы "номенклатура продаж":   
![Функция 2](/Screens/function_test_2.jpg)   
Вызов скрипта тестирования:   
![Тест 2](/Screens/test2.jpg)   
1. Поиск книги и получение подробной информации по стоимости и времени доставки в зависимости от склада.   
![Скрипт 3](/Screens/test_file_3.jpg)   
Скрипт вызывает функцию поиска книги:   
![Функция 3](/Screens/function_test_3.jpg)   
Вызов скрипта тестирования:   
![Тест 3](/Screens/test3.jpg)   
Описание ключей для вызова pgbench с собственным тестовым сценарием можно посмотреть [здесь](https://github.com/mkalinichenko2023/otus_project/tree/main/Scripts/pgbench_info.md)   
На основании полученных результатов тестирования можно поиграть с параметрами PostgreSQL (файл /etc/postgresql/15/main/postgresql.conf) и повысить производительность системы при выполнении конкретных операций.   
***Итог: Выполненная работа позволила более подробно познакомиться с pgbench, изучить особенности ее применения для тестирования конкретных схем данных***   
